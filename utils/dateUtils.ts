export const getDaysInMonth = (year: number, month: number) => new Date(year, month + 1, 0).getDate();

export const getDayOfWeek = (year: number, month: number, day: number) => 
  ['日', '月', '火', '水', '木', '金', '土'][new Date(year, month, day).getDay()];

// Holiday data 2024-2030
// Includes National Holidays, Substitute Holidays, and Citizens' Holidays
const HOLIDAYS = [
  // 2024
  '2024-01-01', '2024-01-08', '2024-02-11', '2024-02-12', '2024-02-23', '2024-03-20', '2024-04-29', '2024-05-03', '2024-05-04', '2024-05-05', '2024-05-06', '2024-07-15', '2024-08-11', '2024-08-12', '2024-09-16', '2024-09-22', '2024-09-23', '2024-10-14', '2024-11-03', '2024-11-04', '2024-11-23',
  // 2025
  '2025-01-01', '2025-01-13', '2025-02-11', '2025-02-23', '2025-02-24', '2025-03-20', '2025-04-29', '2025-05-03', '2025-05-04', '2025-05-05', '2025-05-06', '2025-07-21', '2025-08-11', '2025-09-15', '2025-09-23', '2025-10-13', '2025-11-03', '2025-11-23',
  // 2026 (Sep 22 is Citizens' Holiday)
  '2026-01-01', '2026-01-12', '2026-02-11', '2026-02-23', '2026-03-20', '2026-04-29', '2026-05-03', '2026-05-04', '2026-05-05', '2026-05-06', '2026-07-20', '2026-08-11', '2026-09-21', '2026-09-22', '2026-09-23', '2026-10-12', '2026-11-03', '2026-11-23',
  // 2027
  '2027-01-01', '2027-01-11', '2027-02-11', '2027-02-23', '2027-03-21', '2027-03-22', '2027-04-29', '2027-05-03', '2027-05-04', '2027-05-05', '2027-07-19', '2027-08-11', '2027-09-20', '2027-09-23', '2027-10-11', '2027-11-03', '2027-11-23',
  // 2028
  '2028-01-01', '2028-01-10', '2028-02-11', '2028-02-23', '2028-03-20', '2028-04-29', '2028-05-03', '2028-05-04', '2028-05-05', '2028-07-17', '2028-08-11', '2028-09-18', '2028-09-22', '2028-10-09', '2028-11-03', '2028-11-23',
  // 2029
  '2029-01-01', '2029-01-08', '2029-02-11', '2029-02-12', '2029-02-23', '2029-03-20', '2029-04-29', '2029-04-30', '2029-05-03', '2029-05-04', '2029-05-05', '2029-07-16', '2029-08-11', '2029-09-17', '2029-09-23', '2029-09-24', '2029-10-08', '2029-11-03', '2029-11-23',
  // 2030
  '2030-01-01', '2030-01-14', '2030-02-11', '2030-02-23', '2030-03-20', '2030-04-29', '2030-05-03', '2030-05-04', '2030-05-05', '2030-05-06', '2030-07-15', '2030-08-11', '2030-08-12', '2030-09-16', '2030-09-23', '2030-10-14', '2030-11-03', '2030-11-04', '2030-11-23'
];

export const isNationalHoliday = (year: number, month: number, day: number) => {
  const y = year;
  const m = String(month + 1).padStart(2, '0');
  const d = String(day).padStart(2, '0');
  return HOLIDAYS.includes(`${y}-${m}-${d}`);
};

export const isSpecialHoliday = (month: number, day: number) => {
  if (month === 11 && (day >= 29 && day <= 31)) return true; // 12月
  if (month === 0 && (day >= 1 && day <= 2)) return true; // 1月
  return false;
};

export const isWeekendOrHoliday = (year: number, month: number, day: number) => {
  const dayOfWeek = new Date(year, month, day).getDay();
  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
  return isWeekend || isNationalHoliday(year, month, day) || isSpecialHoliday(month, day);
};

export const shuffleArray = <T>(array: T[]): T[] => {
  const newArray = [...array];
  for (let i = newArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
  }
  return newArray;
};